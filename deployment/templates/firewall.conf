# Firewall Configuration Templates for Simple NTP Daemon
# Choose the appropriate template for your system

# =============================================================================
# UFW (Ubuntu/Debian)
# =============================================================================
# Add to /etc/ufw/applications.d/simple-ntpd
[Simple NTP Daemon]
title=Simple NTP Daemon
description=Network Time Protocol daemon for time synchronization
ports=123/udp

# Commands to run:
# sudo ufw allow 123/udp
# sudo ufw reload

# =============================================================================
# firewalld (RHEL/CentOS/Fedora)
# =============================================================================
# Commands to run:
# sudo firewall-cmd --permanent --add-service=ntp
# sudo firewall-cmd --permanent --add-port=123/udp
# sudo firewall-cmd --reload

# Service definition for /etc/firewalld/services/simple-ntpd.xml:
<?xml version="1.0" encoding="utf-8"?>
<service>
  <short>Simple NTP Daemon</short>
  <description>Simple NTP Daemon for time synchronization</description>
  <port protocol="udp" port="123"/>
</service>

# =============================================================================
# iptables (Traditional Linux)
# =============================================================================
# Commands to run:
# sudo iptables -A INPUT -p udp --dport 123 -j ACCEPT
# sudo iptables -A OUTPUT -p udp --sport 123 -j ACCEPT

# For persistent rules, add to /etc/iptables/rules.v4:
# -A INPUT -p udp --dport 123 -j ACCEPT
# -A OUTPUT -p udp --sport 123 -j ACCEPT

# =============================================================================
# macOS pf (Packet Filter)
# =============================================================================
# Add to /etc/pf.conf:
# pass in proto udp from any to any port 123
# pass out proto udp from any port 123 to any

# Reload rules:
# sudo pfctl -f /etc/pf.conf

# =============================================================================
# Windows Firewall
# =============================================================================
# PowerShell commands:
# New-NetFirewallRule -DisplayName "Simple NTP Daemon" -Direction Inbound -Protocol UDP -LocalPort 123 -Action Allow
# New-NetFirewallRule -DisplayName "Simple NTP Daemon Outbound" -Direction Outbound -Protocol UDP -LocalPort 123 -Action Allow

# =============================================================================
# Docker
# =============================================================================
# Docker automatically handles port exposure, but you may want to restrict access:
# docker run -p 127.0.0.1:123:123/udp simple-ntpd

# =============================================================================
# Kubernetes
# =============================================================================
# Network policies are defined in the deployment manifests
# For additional restrictions, create a NetworkPolicy resource

# =============================================================================
# Cloud Provider Specific
# =============================================================================

# AWS Security Group:
# - Type: Custom UDP Rule
# - Protocol: UDP
# - Port Range: 123
# - Source: 0.0.0.0/0 (or restrict to your VPC)

# Azure Network Security Group:
# - Protocol: UDP
# - Source port range: *
# - Destination port range: 123
# - Action: Allow

# Google Cloud Firewall:
# - Protocol: udp
# - Ports: 123
# - Action: allow
# - Source: 0.0.0.0/0 (or restrict to your VPC)

# =============================================================================
# Advanced Security Rules
# =============================================================================

# Rate limiting with iptables:
# sudo iptables -A INPUT -p udp --dport 123 -m limit --limit 100/minute --limit-burst 200 -j ACCEPT
# sudo iptables -A INPUT -p udp --dport 123 -j DROP

# Geographic restrictions (example for US only):
# sudo iptables -A INPUT -p udp --dport 123 -m geoip --src-cc US -j ACCEPT
# sudo iptables -A INPUT -p udp --dport 123 -j DROP

# =============================================================================
# Monitoring and Logging
# =============================================================================

# Log firewall hits:
# sudo iptables -A INPUT -p udp --dport 123 -j LOG --log-prefix "NTP-ACCESS: "
# sudo iptables -A INPUT -p udp --dport 123 -j ACCEPT

# Monitor connections:
# sudo netstat -ulnp | grep :123
# sudo ss -ulnp | grep :123
# sudo lsof -i :123
