# Logrotate configuration for Simple NTP Daemon
# Place this file in /etc/logrotate.d/simple-ntpd

/var/log/simple-ntpd/*.log {
    daily
    missingok
    rotate 30
    compress
    delaycompress
    notifempty
    create 644 ntp ntp
    postrotate
        # Reload the service to reopen log files
        if systemctl is-active --quiet simple-ntpd; then
            systemctl reload simple-ntpd
        fi
    endscript
    # Alternative for init.d systems
    # postrotate
    #     if [ -f /var/run/simple-ntpd.pid ]; then
    #         kill -HUP $(cat /var/run/simple-ntpd.pid)
    #     fi
    # endscript
}

# Rotate access logs separately if they exist
/var/log/simple-ntpd/access.log {
    daily
    missingok
    rotate 7
    compress
    delaycompress
    notifempty
    create 644 ntp ntp
    postrotate
        if systemctl is-active --quiet simple-ntpd; then
            systemctl reload simple-ntpd
        fi
    endscript
}

# Rotate error logs with longer retention
/var/log/simple-ntpd/error.log {
    daily
    missingok
    rotate 90
    compress
    delaycompress
    notifempty
    create 644 ntp ntp
    postrotate
        if systemctl is-active --quiet simple-ntpd; then
            systemctl reload simple-ntpd
        fi
    endscript
}

# Rotate debug logs (if enabled)
/var/log/simple-ntpd/debug.log {
    daily
    missingok
    rotate 7
    compress
    delaycompress
    notifempty
    create 644 ntp ntp
    postrotate
        if systemctl is-active --quiet simple-ntpd; then
            systemctl reload simple-ntpd
        fi
    endscript
}
